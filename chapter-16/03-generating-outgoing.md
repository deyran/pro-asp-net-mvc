# Chapter 16: Advanced routing features

## Generating outgoing URLs in Views

In MVC applications, the user navigates from one view to another. A static link is used for the first view that targets the action method that generates the second view, as can seen in the code below.

```
<a href="/Home/CustomVariable"> This is an outgoing URL</a>
```

The HTML element creates a simple and quick link to CustomVariable action method on the Home controller. Although simple and quick, hard coded links can be dangerous when changes are needed. All application links must be updated one by one.

The **Routing System** is the alternative to hardcoded link, defining the **URL scheme** to generate outgoing URLs dynamically.

### Using the routing system to generate an outgoing URL

To generate an outgoing URL in view open the */View/Shared/ActionName.cshtml* file, edit it to match in Listing 16-2.

<p align="center">
    <img src="ch16-Pictures/Listing 16-2.png" /><br />
    <b>Listing 16-2.</b> Using the Html.ActionLink helper method in the ActionName.cshtml file
</p>  

As seen in Listing 16-2, **Html.ActionLink** was used to create a link. Run the application and see the result in Figure 16-1.

<p align="center">
    <img src="ch16-Pictures/Figure 16-1.png" /><br />
    <b>Figure 16-1.</b> Adding an outgoing URL to a View
</p>  

The HTML that the ActionLink method generates is based on the current routing configuration. In the example seen in Figure 16-1, the URL scheme was defined in Listing 16-1 generating this HTML:

```
<a href="/Home/CustomVariable">This is an outgoing URL</a>
```

The benefit of this approach is that it automatically responds to changes in the routing configuration. As a demonstration, open the RouteConfig.cs file and edit it to match Listing 16-3:

<p align="center">
    <img src="ch16-Pictures/Listing 16-3.png" /><br />
    <b>Listing 16-3.</b> Adding a route to the RouteConfig.cs file
</p>

The new route changes the URL schema, and it can be seen from the HTML generated by the ActionLink HTML helper method as follows:

```
<a href="/App/DoCustoVariable">This is an outgoing URL</a>
```

As can be seen, changing the routing scheme changes automatically the outgoing of views. Not only that, when the link is clicked, it target to the action method correctly, as shown in Figure 16-2:

<p align="center">
    <img src="ch16-Pictures/Figure 16-2.png" /><br />
    <b>Figure 16-2.</b> The effect of clicking on a link is to make an outgoing URL into an incoming request
</p>

#### UNDERSTANDING OUTBOUND ULS ROUTE MATCHING

* Routes defines URL scheme, changing routes will change URL Scheme.
* Routing System processes routes in the order that they were added to the *RouteCollection* object (RegisterRoutes method)
* Each route is inspected to check whether to match or not
* The route system doesn't attempt to find routes that provides the best matching route. It finds the first match and use the route to generate the URL; Any subsequent routes are ignored
* The most specific route must be defined first
* If no matching route is attempted to create a link, a link will be created with an empty href, as shown in the code below.

```js
<a href="">About this application</a>
```

### Targeting other controllers

To create an outgoing URL that target a different controller, an overload method that lets you specify the name of the controller, as shown in Lising 16-4.

<p align="center">
    <img src="ch16-Pictures/Listing 16-4.png" /><br />
    <b>Listing 16-4.</b> Targeting a different controller in the ActionName.cshtml file
</p>  

When the view is rendered, the following HTML is generated:

```js
<a href="/Admin">This targets another controller</a>
```

The URL generated was expressed as **/Admin** by the ActionLink method. This is because the routing system knows that the defined route uses the **Index** action method by default, omitting unnecessary segments.

It is possible to define the route using the Route Attribute for an action method in a controller. Listing 16-5 shows how to use the Route attribute in the ActionLink method.

<p align="center">
    <img src="ch16-Pictures/Listing 16-5.png" /><br />
    <b>Listing 16-5.</b> Targeting an action decorated with the Route Attribute in the ActionName.cshtml file
</p>  

The link that is generated is as follows:

```js
<a href="/Test">This is targets another controller</a>
```

This corresponds to the Route attribute applied to the Index action method in the Customer controller, as shown in the code below:

```js
[Route("~/Test")]
public ActionResult Index()
{
    ViewBag.Controller = "Customer";
    ViewBag.Action = "Index";
    return View("ActionName");
}
```

### Passing extra values

Using the anonymous type it is possible to pass values that represent the segments. This can be seen in Listing 16-6 applied to the ActionName.cshtml view file.

<p align="center">
    <img src="ch16-Pictures/Listing 16-6.png" /><br />
    <b>Listing 16-6.</b> Supplying for segment variables in the ActionName.cshtml file
</p>  

As can be seen, a value for a segment variable named **id** was supplied. If the application runs, the HTML element below will be rendered in view (The route seen in Listing 16-3 is used).

```js
<a href="/App/DoCustomVariable?id=Hello">This is an outgoing URL</a>
```

Note that the provided value is part of the query string to match the URL pattern. This is because there is no segment variable that corresponds to id in that route. In Listing 16-7, the routes have been edited to leave only one route that has a segment id.

<p align="center">
    <img src="ch16-Pictures/Listing 16-7.png" /><br />
    <b>Listing 16-7.</b> Editing the routes in the RouteConfig.cs file
</p>  

#### UNDERSTANDING SEGMENT VARIABLE REUSE

In previous sections was explained the process that the routes are matched for outbound URL. This is a behavior that confuses many programmers and can lead to a lengthy debugging session.

Imagine the application has a single route, as follows:

```js
routes.MapRoutes("MyRoute", "{controller}/{action}/{color}/{page}");
```

Now imagine that a user is currently at the URL */Catalog/List/Purple/123*, and render a link as follows:

```js
#Html.ActionLink("Click me", "List", "Catalog", new {page=789}, null)
```

There are two reasons to think that the Routing System is not capable of handling this:

1. Color value was not provided
2. There is no default value defined

But it's wrong! The routing system will match the defined route. It will generate the following HTML

```js
<a href="Catalog/List/Purple/789">Click me</a>
```

<!--
# Chapter 16: Advanced routing features
## Generating outgoing URLs in Views
### Passing extra values
#### UNDERSTANDING SEGMENT VARIABLE REUSE
-->

### Specifying HTML attributes

### Generating fully qualified URLs in links

### Generating URLs (and not links)

### Generating Outgoing URLs in action methods

### Generating a URL from a specific route

<!--
> SUMMARRY AND UPDATE ==========================
.
> CONTENTS =====================================
# Chapter 16: Advanced routing features
## Generating outgoing URLs in Views
### Using the routing system to generate an outgoing URL
### Targeting other controllers
### Passing extra values
### Specifying HTML attributes
### Generating fully qualified URLs in links
### Generating URLs (and not links)
### Generating Outgoing URLs in action methods
### Generating a URL from a specific route
.
> GITHUB =====================================
https://github.com/deyran/pro-asp-net-mvc/blob/main/chapter-16/03-generating-outgoing.md
.
> # ==========================================
#DotNet #csharp #csharpdotnet #dotnetcore #csharpdeveloper #dotnetdevelopers #aspnetcore #ASPNET #aspdotnet #IT #developer #TI #tecnologia #DevOps #desenvolvedor #programador #software #homeoffice #dev #tecnologiadainformacao #devs #code #programacao #programação #tecnologiadainformação #sistemasdeinformação #engenhariadesoftware #GitHub #ASPNETMVC #ASPNET #MVC #core #MVC #route #urlroute #urlroting #urlpatterns #RoutingSystem
-->

[<BACK](02-preparing-the-example-proj.md) - [NEXT>](03-generating-outgoing.md)
